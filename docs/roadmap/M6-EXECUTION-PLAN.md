# üöÄ M6 - QR Ordering System: Plan de Ejecuci√≥n Completo

**Fecha de Inicio**: 2025-10-11  
**Fecha Objetivo**: 2025-11-15 (35 d√≠as)  
**Branch**: `feature/qr-ordering-system`  
**Responsable**: AlvaFG  
**Estado Actual**: 15% completado (√âpica 2.3 ‚úÖ)

---

## üìä Estado Actual del M6

### ‚úÖ Completado (15%)
- ‚úÖ **√âpica 2.3**: Item Customization & Modifiers (100%)
  - Sistema completo de modificadores
  - 31 tests unitarios + 4 tests API
  - Documentaci√≥n (850+ l√≠neas)
  - Performance optimization (dynamic import)

### ‚ö†Ô∏è Parcialmente Completado (10%)
- ‚ö†Ô∏è **√âpica 1.2**: Session Management (50%)
  - ‚úÖ `use-qr-session.ts` hook implementado
  - ‚ùå Backend session store faltante
  - ‚ùå API de validaci√≥n faltante

- ‚ö†Ô∏è **√âpica 2.1**: Mobile Menu Layout (50%)
  - ‚úÖ P√°gina QR b√°sica implementada
  - ‚ùå Tabs de categor√≠as faltantes
  - ‚ùå Virtual scrolling faltante
  - ‚ùå B√∫squeda faltante

- ‚ö†Ô∏è **√âpica 2.2**: Shopping Cart (100%)
  - ‚úÖ `use-qr-cart.ts` implementado completo
  - ‚úÖ Persistencia localStorage
  - ‚úÖ CustomizationId support

### ‚ùå Pendiente (75%)
- ‚ùå √âpica 1.1, 1.3: QR Generation + Admin UI
- ‚ùå √âpica 2.4: Performance final
- ‚ùå √âpica 3: Checkout completo
- ‚ùå √âpica 4: Payment (opcional)
- ‚ùå √âpica 5: Admin & Analytics
- ‚ùå √âpica 6: Testing & QA

---

## üéØ Plan de Ejecuci√≥n - 5 Semanas

### **SEMANA 1: Completar Infrastructure (√âpica 1)**
**Objetivo**: Sistema QR funcional end-to-end  
**D√≠as**: 5 d√≠as laborables  
**Prioridad**: üî¥ CR√çTICA

#### **D√≠a 1-2: QR Generation System**
```typescript
// FASE 4.1: Backend QR Generation
Archivos a crear:
- lib/server/qr-service.ts (generaci√≥n QR)
- lib/server/qr-types.ts (tipos)
- app/api/qr/generate/route.ts (API endpoint)
- lib/server/__tests__/qr-service.test.ts (tests)

Tareas:
[ ] Instalar dependencia: npm install qrcode
[ ] Crear QR service con JWT tokens
[ ] Implementar generaci√≥n de QR codes (base64 + URL)
[ ] Agregar campos qrToken y qrTokenExpiry a Table
[ ] API POST /api/qr/generate { tableId } ‚Üí { qrCode, url, token, expiresAt }
[ ] Tests: generaci√≥n v√°lida, expiraci√≥n, tokens inv√°lidos

Entregables:
‚úÖ QR codes generables por mesa
‚úÖ Tokens JWT seguros (24h expiry)
‚úÖ 5 tests unitarios pasando

Validaci√≥n:
- curl POST http://localhost:3000/api/qr/generate -d '{"tableId":"1"}'
- Verificar response con qrCode base64
```

#### **D√≠a 2-3: Session Management Backend**
```typescript
// FASE 4.2: Backend Session Store
Archivos a crear:
- lib/server/session-store.ts (store en memoria)
- lib/server/session-manager.ts (l√≥gica de negocio)
- lib/server/session-types.ts (tipos)
- app/api/qr/validate/route.ts (API validaci√≥n)
- lib/server/__tests__/session-manager.test.ts

Tareas:
[ ] Implementar SessionStore (Map-based con TTL)
[ ] createGuestSession(tableId) ‚Üí sessionId
[ ] getSession(sessionId) ‚Üí session data
[ ] extendSession(sessionId) ‚Üí refresh TTL
[ ] invalidateSession(sessionId) ‚Üí cleanup
[ ] Cleanup autom√°tico de sesiones expiradas (setInterval)
[ ] API POST /api/qr/validate { token } ‚Üí { valid, tableId, sessionId, table }
[ ] Rate limiting: 10 req/min por IP
[ ] Tests: crear, recuperar, expirar, limpiar

Entregables:
‚úÖ Session store funcional
‚úÖ TTL 2 horas con auto-renovaci√≥n
‚úÖ API de validaci√≥n
‚úÖ 8 tests pasando

Validaci√≥n:
- curl POST http://localhost:3000/api/qr/validate -d '{"token":"eyJ..."}'
- Verificar sessionId en response
```

#### **D√≠a 4-5: QR Management UI (Admin)**
```typescript
// FASE 4.3: Admin UI para QR
Archivos a crear:
- components/generate-qr-modal.tsx
- components/qr-print-template.tsx
- app/mesas/_components/qr-actions.tsx

Tareas:
[ ] Bot√≥n "Generar QR" en cada mesa (/mesas)
[ ] Modal GenerateQRModal:
  - Preview del QR code
  - Bot√≥n "Descargar PNG"
  - Bot√≥n "Descargar PDF"
  - Copiar URL al clipboard
  - Bot√≥n "Imprimir"
[ ] Batch generation: "Generar todos los QRs"
[ ] Print template con:
  - Logo del restaurante
  - N√∫mero de mesa grande
  - QR code centrado
  - Instrucciones de uso
  - URL de respaldo
[ ] Integrar con TableList component

Entregables:
‚úÖ UI funcional en /mesas
‚úÖ Descarga PNG/PDF funciona
‚úÖ Impresi√≥n optimizada
‚úÖ Batch generation operativo

Validaci√≥n:
- Abrir /mesas
- Click "Generar QR" en mesa 1
- Descargar y verificar PNG
- Imprimir y verificar calidad
```

**üéØ Milestone Semana 1**: QR Infrastructure completa al 100%

---

### **SEMANA 2: Completar Mobile Menu (√âpica 2.1 + 2.4)**
**Objetivo**: Menu mobile optimizado y performante  
**D√≠as**: 5 d√≠as laborables  
**Prioridad**: üî¥ CR√çTICA

#### **D√≠a 6-7: Mobile Menu Layout**
```typescript
// FASE 5.1: Optimizar Menu Mobile
Archivos a modificar:
- app/(public)/qr/[tableId]/page.tsx (refactor)
- app/(public)/qr/_components/qr-menu-header.tsx (nuevo)
- app/(public)/qr/_components/qr-category-tabs.tsx (nuevo)
- app/(public)/qr/_components/qr-search-bar.tsx (nuevo)

Tareas:
[ ] Header sticky mobile:
  - Logo/nombre del restaurante
  - N√∫mero de mesa
  - Badge de carrito con contador
  - Bot√≥n men√∫ (hamburger)
[ ] Tabs de categor√≠as horizontales:
  - Scroll horizontal con snap
  - Active state visual claro
  - Touch-friendly (min 44px height)
  - Sticky position
[ ] Barra de b√∫squeda:
  - Filtrado en tiempo real
  - Debounce 300ms
  - Highlights de resultados
  - Empty state amigable
[ ] Optimizar MenuItemCard:
  - Lazy loading de im√°genes
  - Skeleton loading states
  - Touch feedback
  - Badges visuales (Popular, Agotado)
[ ] Virtual scrolling con react-window
[ ] Iconos de al√©rgenos m√°s visuales

Entregables:
‚úÖ Menu mobile-first optimizado
‚úÖ Categor√≠as tabs funcionales
‚úÖ B√∫squeda en tiempo real
‚úÖ Performance mejorado

Validaci√≥n:
- Abrir /qr/1 en mobile
- Scroll debe ser fluido (60fps)
- B√∫squeda instant√°nea
- Tabs responsive
```

#### **D√≠a 8: Performance Optimization**
```typescript
// FASE 5.2: Performance Final
Archivos a crear/modificar:
- public/sw.js (service worker)
- next.config.mjs (optimizaciones)
- app/(public)/qr/_components/* (lazy loading)

Tareas:
[ ] Service Worker para offline:
  - Cache de assets est√°ticos
  - Cache de im√°genes del menu
  - Stale-while-revalidate strategy
  - Offline fallback page
[ ] Image optimization:
  - Convertir a WebP con fallback
  - Blur placeholders
  - Lazy loading agresivo
  - Responsive images (srcset)
[ ] Code splitting avanzado:
  - Dynamic imports para modales
  - Route-based splitting
  - Prefetch cr√≠tico solamente
[ ] Bundle optimization:
  - Tree shaking verificado
  - Analizar con @next/bundle-analyzer
  - Eliminar dependencies innecesarias
[ ] Compression:
  - Gzip/Brotli habilitado
  - Minificaci√≥n agresiva

Entregables:
‚úÖ Service Worker funcional
‚úÖ First Load JS <200KB
‚úÖ LCP <2.5s en 3G
‚úÖ Lighthouse score >90

Validaci√≥n:
- npm run build && npm run analyze
- Lighthouse audit en mobile
- Verificar offline mode funciona
```

#### **D√≠a 9-10: Polish & Refinement**
```typescript
// FASE 5.3: UX Refinements
Tareas:
[ ] Loading states consistentes
[ ] Error boundaries en todos los componentes
[ ] Toast notifications user-friendly
[ ] Animaciones micro-interactions:
  - Agregar al carrito (bounce)
  - Tab change (slide)
  - Item expand (fade)
[ ] Accessibility:
  - ARIA labels correctos
  - Keyboard navigation
  - Screen reader support
  - Contrast ratio >4.5:1
[ ] Empty states:
  - Carrito vac√≠o con CTA
  - Sin resultados de b√∫squeda
  - Menu no disponible
[ ] Testing manual en devices:
  - iPhone (Safari)
  - Android (Chrome)
  - Tablet (iPad)

Entregables:
‚úÖ UX pulida y consistente
‚úÖ A11y compliant
‚úÖ Tested en 3+ devices

Validaci√≥n:
- Testing con usuarios reales
- Feedback de UX positivo
```

**üéØ Milestone Semana 2**: Mobile Menu completo al 100%

---

### **SEMANA 3: Checkout & Order Flow (√âpica 3)**
**Objetivo**: Flujo completo de pedido funcional  
**D√≠as**: 5 d√≠as laborables  
**Prioridad**: üî¥ CR√çTICA

#### **D√≠a 11-12: Checkout Form**
```typescript
// FASE 6.1: Checkout UI
Archivos a crear:
- app/(public)/qr/[tableId]/checkout/page.tsx
- app/(public)/qr/_components/checkout-form.tsx
- app/(public)/qr/_components/tip-selector.tsx
- app/(public)/qr/_components/order-summary.tsx
- app/(public)/qr/_hooks/use-checkout.ts

Tareas:
[ ] P√°gina /qr/[tableId]/checkout
[ ] Formulario minimal:
  - Nombre (opcional)
  - N√∫mero de mesa (pre-filled, readonly)
  - Notas adicionales para el pedido (textarea)
[ ] Selector de propina:
  - Botones: 10%, 15%, 20%
  - Input custom
  - Opci√≥n "Sin propina"
[ ] Order Summary component:
  - Lista de items con modifiers
  - Subtotal
  - Propina
  - Total destacado
[ ] Opciones de pago:
  - Radio buttons: "Pagar en mesa" (default), "Pagar ahora"
[ ] Validaciones:
  - Carrito no vac√≠o
  - Mesa v√°lida
  - Items disponibles en stock (revalidaci√≥n)
[ ] Bot√≥n "Confirmar Pedido":
  - Loading state
  - Disable on submit
  - Error handling

Entregables:
‚úÖ Checkout form funcional
‚úÖ C√°lculos correctos
‚úÖ UX clara y simple

Validaci√≥n:
- Agregar items al carrito
- Ir a checkout
- Seleccionar propina
- Ver totales correctos
```

#### **D√≠a 12-13: Order Submission API**
```typescript
// FASE 6.2: Backend Order Creation
Archivos a crear:
- app/api/qr/order/route.ts
- lib/server/qr-order-service.ts
- app/api/__tests__/qr-order.test.ts

Tareas:
[ ] API POST /api/qr/order:
  - Request: { sessionId, tableId, items, tip?, notes?, paymentMethod }
  - Validaciones:
    - Sesi√≥n v√°lida y no expirada
    - Mesa existe y disponible
    - Items existen en menu
    - Stock disponible
  - Crear orden en OrderStore
  - Actualizar estado de mesa ‚Üí "pedido_en_curso"
  - Generar orderNumber √∫nico
  - Calcular estimatedTime (15-30 min)
  - Emitir WebSocket event: "order:created"
  - Response: { orderId, orderNumber, estimatedTime }
[ ] QrOrderService:
  - validateQrOrder(sessionId, items)
  - createQrOrder(data)
  - notifyStaff(orderId)
[ ] Tests API:
  - Crea orden correctamente
  - Valida sesi√≥n
  - Valida stock
  - Rechaza items no disponibles
  - Calcula totales con propina
  - Actualiza mesa
  - Emite WebSocket

Entregables:
‚úÖ API funcional
‚úÖ Validaciones robustas
‚úÖ WebSocket notifications
‚úÖ 6 tests pasando

Validaci√≥n:
- curl POST /api/qr/order con payload v√°lido
- Verificar orden en DB
- Verificar mesa actualizada
- Verificar WebSocket event
```

#### **D√≠a 13-14: Order Confirmation & Tracking**
```typescript
// FASE 6.3: Confirmation & Real-time
Archivos a crear:
- app/(public)/qr/[tableId]/confirmed/page.tsx
- app/(public)/qr/[tableId]/tracking/[orderId]/page.tsx
- app/(public)/qr/_components/order-timeline.tsx
- app/(public)/qr/_hooks/use-order-tracking.ts

Tareas:
[ ] P√°gina de confirmaci√≥n:
  - N√∫mero de pedido GRANDE
  - Checkmark animado
  - Tiempo estimado
  - Resumen del pedido
  - Botones:
    - "Ver estado" ‚Üí /tracking/[orderId]
    - "Hacer otro pedido" ‚Üí back to menu
  - Mensaje de agradecimiento
[ ] P√°gina de tracking:
  - Timeline visual de estados:
    ‚úÖ Pedido recibido
    üç≥ En preparaci√≥n
    ‚ú® Listo para servir
    üéâ Servido
  - Current state highlighted
  - Tiempo estimado restante
  - Lista de items
  - Bot√≥n "Llamar mesero" (crea alerta)
[ ] Real-time updates:
  - WebSocket connection
  - Subscribe a "order:updated"
  - Auto-update timeline
  - Fallback: polling cada 30s
[ ] Notifications:
  - Toast cuando estado cambia
  - "Tu pedido est√° listo!"
  - Sonido opcional

Entregables:
‚úÖ Confirmaci√≥n visual clara
‚úÖ Tracking en tiempo real
‚úÖ Timeline UX excelente

Validaci√≥n:
- Confirmar pedido
- Ver confirmaci√≥n
- Ir a tracking
- Cambiar estado desde admin
- Verificar update en tiempo real
```

#### **D√≠a 15: Testing & Fixes**
```typescript
// FASE 6.4: Integration Testing
Tareas:
[ ] E2E test del flujo completo:
  - Scan QR ‚Üí Menu ‚Üí Add items ‚Üí Checkout ‚Üí Confirm ‚Üí Track
[ ] Validar edge cases:
  - Items agotados durante checkout
  - Sesi√≥n expira durante pedido
  - Conexi√≥n perdida durante submit
  - Multiple orders misma mesa
[ ] Performance test:
  - 10 pedidos simult√°neos
  - 100 items en menu
  - Conexi√≥n 3G
[ ] Fixes de bugs encontrados

Entregables:
‚úÖ Flujo completo funcional
‚úÖ Edge cases manejados
‚úÖ Bugs cr√≠ticos resueltos

Validaci√≥n:
- Testing manual completo
- No errores en consola
- Performance aceptable
```

**üéØ Milestone Semana 3**: Checkout Flow completo al 100%

---

### **SEMANA 4: Payment, Admin & Analytics (√âpicas 4+5)**
**Objetivo**: Features avanzadas y management  
**D√≠as**: 5 d√≠as laborables  
**Prioridad**: üü° MEDIA (√âpica 4 opcional)

#### **D√≠a 16-17: QR Payment Integration** *(OPCIONAL)*
```typescript
// FASE 7.1: Payment Flow (si se requiere)
Archivos a crear:
- app/api/qr/payment/create/route.ts
- app/(public)/qr/[tableId]/payment/success/page.tsx
- app/(public)/qr/[tableId]/payment/failure/page.tsx

Tareas:
[ ] Reutilizar componentes de M5:
  - PaymentModal
  - CheckoutButton
  - Payment hooks
[ ] Adaptar para QR (sin login):
  - Email opcional del cliente
  - Redirect URLs espec√≠ficas
  - Session-based payment
[ ] API POST /api/qr/payment/create:
  - Request: { orderId, sessionId, customerEmail? }
  - Crear payment en MercadoPago
  - Response: { checkoutUrl, paymentId }
[ ] Success/failure pages
[ ] Actualizar orden con payment status
[ ] WebSocket: "payment:completed"

Entregables:
‚úÖ Pago online desde QR funcional
‚úÖ Redirect correcto
‚úÖ Orden marcada como pagada

‚ö†Ô∏è SKIP SI NO ES PRIORIDAD - Ir directo a √âpica 5
```

#### **D√≠a 17-18: Split Bill** *(OPCIONAL)*
```typescript
// FASE 7.2: Split Bill (si se requiere)
Archivos:
- app/(public)/qr/_components/split-bill-modal.tsx
- app/(public)/qr/_hooks/use-split-bill.ts

Tareas:
[ ] Modal "Dividir cuenta"
[ ] Opciones:
  - Por n√∫mero de personas (equitativo)
  - Por items (seleccionar items)
  - Custom (monto manual)
[ ] C√°lculo autom√°tico con propina
[ ] M√∫ltiples checkouts
[ ] Tracking de pagos parciales

Entregables:
‚úÖ Split bill funcional

‚ö†Ô∏è SKIP SI NO ES PRIORIDAD
```

#### **D√≠a 18-19: QR Orders Dashboard**
```typescript
// FASE 8.1: Admin Dashboard
Archivos a modificar:
- app/pedidos/page.tsx
- components/orders-panel.tsx (agregar filtros)

Archivos a crear:
- app/pedidos/_components/qr-orders-tab.tsx
- app/pedidos/_components/qr-order-badge.tsx

Tareas:
[ ] Tab "Pedidos QR" en /pedidos
[ ] Badge "QR" visual en cada pedido QR
[ ] Filtros adicionales:
  - Solo pedidos QR
  - Por mesa
  - Por sesi√≥n
  - Por m√©todo de pago
[ ] Indicador de guest user
[ ] Quick actions:
  - Cambiar estado
  - Ver detalles de sesi√≥n
  - Contactar cliente (si dej√≥ email)
[ ] Estad√≠sticas inline:
  - Total QR del d√≠a
  - Ticket promedio QR
  - Tiempo promedio

Entregables:
‚úÖ Dashboard funcional
‚úÖ Filtros operativos
‚úÖ Stats visibles

Validaci√≥n:
- Crear pedido QR
- Ir a /pedidos
- Ver tab QR
- Verificar badge
- Filtrar solo QR
```

#### **D√≠a 19-20: QR Analytics**
```typescript
// FASE 8.2: Analytics espec√≠ficos QR
Archivos a crear:
- app/analitica/qr/page.tsx
- lib/server/qr-analytics.ts
- app/api/analytics/qr/route.ts

Tareas:
[ ] M√©tricas QR:
  - Total scans por d√≠a/semana/mes
  - Tasa de conversi√≥n (scan ‚Üí orden)
  - Tiempo promedio en menu
  - Items m√°s ordenados v√≠a QR
  - Horarios pico de uso QR
  - Comparativa QR vs tradicional
  - Ticket promedio por canal
  - Abandono de carrito
[ ] Dashboard visual:
  - Gr√°fico de scans (l√≠nea)
  - Funnel de conversi√≥n
  - Top items QR (bar chart)
  - Heatmap por horario
  - Tabla de mesas m√°s activas
[ ] Filtros:
  - Rango de fechas
  - Por mesa
  - Por categor√≠a
[ ] Export a CSV

Entregables:
‚úÖ Analytics completo
‚úÖ Visualizaciones claras
‚úÖ Export funcional

Validaci√≥n:
- Generar datos de prueba
- Abrir /analitica/qr
- Verificar m√©tricas correctas
- Export CSV
```

**üéØ Milestone Semana 4**: Features avanzadas completas

---

### **SEMANA 5: Testing, QA & Go-Live (√âpica 6)**
**Objetivo**: Asegurar calidad y lanzar  
**D√≠as**: 5 d√≠as laborables  
**Prioridad**: üî¥ CR√çTICA

#### **D√≠a 21-22: Unit & Integration Tests**
```typescript
// FASE 9.1: Tests comprehensivos
Tareas:
[ ] QR Service tests (target 90%):
  - generateQR()
  - validateQRToken()
  - refreshQRToken()
[ ] Session Manager tests (target 95%):
  - createGuestSession()
  - extendSession()
  - cleanup()
[ ] Checkout flow tests:
  - use-checkout hook
  - Tip calculations
  - Order submission
[ ] API tests:
  - /api/qr/generate
  - /api/qr/validate
  - /api/qr/order
  - /api/analytics/qr
[ ] Component tests cr√≠ticos:
  - QrMenuItemCard
  - CheckoutForm
  - OrderTimeline
[ ] Verificar coverage:
  - npm run test:coverage
  - Target: >85% coverage total

Entregables:
‚úÖ >85% test coverage
‚úÖ Todos los tests pasando
‚úÖ 0 flaky tests

Validaci√≥n:
- npm test
- Verificar report de coverage
- Todos los suites green
```

#### **D√≠a 23: E2E Testing**
```typescript
// FASE 9.2: End-to-End Testing
Tareas:
[ ] Setup Playwright/Cypress
[ ] E2E test scenarios:
  1. Happy path completo:
     - Scan QR
     - Browse menu
     - Add items con customization
     - Checkout con propina
     - Confirm order
     - Track order
  2. Error scenarios:
     - QR expirado
     - Sesi√≥n inv√°lida
     - Item agotado durante checkout
     - Network error durante submit
  3. Edge cases:
     - Multiple tabs misma mesa
     - Back button durante checkout
     - Refresh durante tracking
[ ] Performance testing:
  - Lighthouse CI setup
  - M√©tricas: LCP <2.5s, FID <100ms, CLS <0.1
  - Test en 3G throttling
[ ] Device testing:
  - iPhone 12/13 (Safari)
  - Samsung Galaxy (Chrome)
  - iPad (Safari)
  - Tablet Android

Entregables:
‚úÖ E2E suite completo
‚úÖ Performance benchmarks
‚úÖ Device compatibility verified

Validaci√≥n:
- npx playwright test
- Lighthouse score >90
- Tests en devices reales
```

#### **D√≠a 24: User Acceptance Testing**
```typescript
// FASE 9.3: UAT & Beta Testing
Tareas:
[ ] Setup beta testing:
  - Imprimir 2-3 QRs de prueba
  - Configurar 1-2 mesas de test
  - Briefing al staff
[ ] Invitar beta testers:
  - 5-10 personas (staff + amigos)
  - Dar instrucciones claras
  - Preparar formulario de feedback
[ ] Scenarios de test:
  - Ordenar plato simple
  - Ordenar con customization
  - Agregar propina
  - Hacer pedido completo
  - Tracking en tiempo real
[ ] Recopilar feedback:
  - Usabilidad (1-5)
  - Claridad del flujo
  - Performance percibida
  - Bugs encontrados
  - Mejoras sugeridas
[ ] An√°lisis y priorizaci√≥n:
  - Bugs cr√≠ticos ‚Üí fix inmediato
  - Mejoras UX ‚Üí evaluar
  - Nice-to-have ‚Üí backlog

Entregables:
‚úÖ Beta testing completado
‚úÖ Feedback recopilado
‚úÖ Bugs cr√≠ticos resueltos

Validaci√≥n:
- >80% feedback positivo
- 0 bugs bloqueantes
- UX score >4/5
```

#### **D√≠a 25: Final Polish & Documentation**
```typescript
// FASE 9.4: Pre-Launch Checklist
Tareas:
[ ] Code cleanup:
  - Eliminar console.logs
  - Eliminar c√≥digo comentado
  - Eliminar TODOs
  - Formatear c√≥digo
  - ESLint 0 warnings
[ ] Documentation:
  - README actualizado
  - API documentation completa
  - User guide para staff
  - Troubleshooting guide
  - Video tutorial (opcional)
[ ] Security audit:
  - Revisar rate limiting
  - Validar JWT tokens
  - Verificar CORS
  - Input sanitization
  - SQL injection prevention
[ ] Performance final check:
  - npm run build
  - Analizar bundle size
  - Verificar no memory leaks
  - Load testing b√°sico
[ ] Pre-launch checklist:
  - [ ] Tests passing ‚úÖ
  - [ ] Lighthouse >90 ‚úÖ
  - [ ] Security audit ‚úÖ
  - [ ] Documentation ‚úÖ
  - [ ] Staff training ‚úÖ
  - [ ] QRs impresos ‚úÖ
  - [ ] Backup plan ‚úÖ
  - [ ] Rollback plan ‚úÖ

Entregables:
‚úÖ C√≥digo production-ready
‚úÖ Documentation completa
‚úÖ Pre-launch checklist completo

Validaci√≥n:
- Review completo del c√≥digo
- Checklist 100% completado
```

**üéØ Milestone Semana 5**: M6 completo y listo para producci√≥n!

---

## üìà Tracking de Progreso

### M√©tricas Clave
```javascript
const m6Metrics = {
  // Development
  filesCreated: 0,      // Target: ~35 files
  filesModified: 0,     // Target: ~20 files
  linesOfCode: 0,       // Target: ~3500 LOC
  
  // Testing
  unitTests: 39,        // Actual (from Fase 3), Target: 80
  integrationTests: 4,  // Actual (from Fase 3), Target: 15
  e2eTests: 0,          // Target: 10
  testCoverage: 0,      // Target: 85%
  
  // Performance
  bundleSize: 254,      // Current KB, Target: <200KB
  lighthouseScore: 0,   // Target: >90
  loadTime3G: 0,        // Target: <2.5s
  
  // Features
  epicasCompleted: 1,   // (√âpica 2.3), Target: 6
  tasksCompleted: 8,    // Target: 45
  progressPercent: 15,  // Target: 100%
}
```

### Dashboard de Progreso
```
M6 - QR ORDERING SYSTEM
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

√âPICAS COMPLETADAS: 1/6 (17%)
‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë

√âPICA 1: QR Infrastructure        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë   0% ‚ùå
√âPICA 2: Mobile Menu Experience   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë  75% ‚ö†Ô∏è
√âPICA 3: Checkout & Order Flow    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë   0% ‚ùå
√âPICA 4: Payment Integration      ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë   0% ‚ùå (opcional)
√âPICA 5: Admin & Analytics        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë   0% ‚ùå
√âPICA 6: Testing & QA             ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  30% ‚ö†Ô∏è

TESTS: 43/105 passing (41%)
COVERAGE: 45% (target: 85%)
LIGHTHOUSE: 0 (target: 90+)

TIEMPO RESTANTE: 20 d√≠as laborables
BURN RATE: ‚ö†Ô∏è Debe completar 1 √©pica cada 3 d√≠as
```

---

## üö® Riesgos y Mitigaciones

### Riesgos Cr√≠ticos
| # | Riesgo | Probabilidad | Impacto | Mitigaci√≥n | Owner |
|---|--------|--------------|---------|------------|-------|
| 1 | UX mobile confusa | üü° Media | üî¥ Alto | UAT temprano d√≠a 24, iteraciones r√°pidas | Dev |
| 2 | Performance <90 Lighthouse | üü° Media | üî¥ Alto | Optimizaci√≥n continua semana 2, no dejar para el final | Dev |
| 3 | Session management bugs | üü¢ Baja | üî¥ Alto | Tests robustos, timeout generoso (2h), logs extensivos | Dev |
| 4 | QR codes no escanean | üü¢ Baja | üî¥ Alto | Test con m√∫ltiples devices, tama√±o adecuado (300x300px min) | QA |
| 5 | Scope creep (features extra) | üî¥ Alta | üü° Medio | Seguir plan estrictamente, parking lot para ideas | PM |
| 6 | Bugs en producci√≥n | üü° Media | üü° Medio | Testing exhaustivo semana 5, rollback plan, feature flags | Ops |

### Plan de Contingencia
```javascript
const contingencyPlan = {
  ifBehindSchedule: [
    "Mover √âpica 4 (Payment) a M7",
    "Reducir √âpica 5 (Analytics) a versi√≥n minimal",
    "Posponer features nice-to-have"
  ],
  ifBlockingBug: [
    "Crear hotfix branch",
    "Fix y deploy en <4 horas",
    "Comunicar a stakeholders",
    "Post-mortem"
  ],
  ifPerformanceIssues: [
    "Code splitting agresivo",
    "Lazy loading m√°s features",
    "Reducir bundle dependencies",
    "CDN para assets pesados"
  ]
}
```

---

## ‚úÖ Definition of Done - M6

El M6 est√° **DONE** cuando:

### Funcionalidad
- ‚úÖ Cliente puede escanear QR y acceder al menu
- ‚úÖ Cliente puede agregar items con customization
- ‚úÖ Cliente puede completar checkout
- ‚úÖ Cliente puede pagar (en mesa o online)
- ‚úÖ Cliente puede trackear su pedido en tiempo real
- ‚úÖ Staff recibe pedidos QR en tiempo real
- ‚úÖ Staff puede generar/gestionar QR codes
- ‚úÖ Admin puede ver analytics de QR

### Calidad
- ‚úÖ >85% test coverage
- ‚úÖ 0 bugs cr√≠ticos
- ‚úÖ <3 bugs menores
- ‚úÖ Lighthouse mobile >90
- ‚úÖ WCAG AA compliant
- ‚úÖ Performance: LCP <2.5s en 3G

### Documentaci√≥n
- ‚úÖ README actualizado
- ‚úÖ API docs completos
- ‚úÖ User guide para staff
- ‚úÖ Video tutorial
- ‚úÖ Troubleshooting guide

### Deployment
- ‚úÖ Branch merged a main
- ‚úÖ CI/CD passing
- ‚úÖ Feature flags configurados
- ‚úÖ Monitoring configurado
- ‚úÖ Rollback plan documentado

### Training
- ‚úÖ Staff capacitado (>90% asistencia)
- ‚úÖ User manual distribuido
- ‚úÖ Support channel establecido
- ‚úÖ FAQs creadas

---

## üéâ Go-Live Plan

### Pre-Launch (D√≠a 24-25)
```bash
# 1. Final testing
npm run test
npm run test:e2e
npm run build

# 2. Generate QR codes
- Imprimir QRs de todas las mesas
- Laminar y colocar en mesas

# 3. Staff training
- Briefing de 30 minutos
- Demo en vivo
- Q&A session

# 4. Monitoring setup
- Setup error tracking (Sentry)
- Setup analytics (GA4)
- Setup uptime monitoring
```

### Launch Day (D√≠a 26)
```bash
# Soft Launch (Mesa 1-3 solamente)
08:00 - Colocar QRs en mesas piloto
09:00 - Monitorear primera orden
10:00 - Evaluar feedback inicial
12:00 - Ajustar si necesario

# Full Launch (Todas las mesas)
14:00 - Colocar todos los QRs
15:00 - Monitoreo activo
18:00 - Review de m√©tricas
20:00 - Celebrar üéâ
```

### Post-Launch (D√≠a 27-30)
```bash
# Week 1 Monitoring
- Metrics diarias
- Recopilar feedback
- Hotfixes si necesario
- Iterar mejoras

# Week 2-4
- Feature refinement
- Performance optimization
- Documentation updates
```

---

## üìû Contacto y Recursos

**Project Lead**: AlvaFG  
**Repository**: [restaurant-digital](https://github.com/AlvaFG/restaurant-digital)  
**Branch**: `feature/qr-ordering-system`  
**Slack Channel**: #m6-qr-ordering (si existe)  
**Documentation**: `/docs/roadmap/`  

**Daily Standup**: 10:00 AM (opcional si es solo dev)  
**Weekly Review**: Viernes 16:00  

---

## üìö Referencias y Recursos

### Librer√≠as a Instalar
```bash
npm install qrcode                    # QR generation
npm install jsonwebtoken              # JWT tokens
npm install @types/jsonwebtoken --save-dev
npm install react-window              # Virtual scrolling
npm install @next/bundle-analyzer --save-dev
npm install playwright --save-dev     # E2E testing
```

### Documentation Links
- [QRCode.js Docs](https://github.com/soldair/node-qrcode)
- [JWT Best Practices](https://auth0.com/blog/a-look-at-the-latest-draft-for-jwt-bcp/)
- [Next.js Performance](https://nextjs.org/docs/advanced-features/measuring-performance)
- [Lighthouse CI](https://github.com/GoogleChrome/lighthouse-ci)
- [React Window](https://github.com/bvaughn/react-window)

### Inspiraci√≥n UX
- [Uber Eats Mobile](https://ubereats.com) - Menu layout
- [DoorDash](https://doordash.com) - Checkout flow
- [Square Order](https://squareup.com/us/en/point-of-sale/order) - QR ordering

---

## üîÑ Actualizaci√≥n del Plan

Este plan se actualizar√°:
- ‚úèÔ∏è Diariamente: Progreso de tareas
- üìä Semanalmente: M√©tricas y riesgos
- üéØ Al completar √©pica: Retrospectiva

**√öltima actualizaci√≥n**: 2025-10-11  
**Pr√≥xima revisi√≥n**: 2025-10-18 (fin Semana 1)  
**Versi√≥n del plan**: 1.0.0

---

**¬øListo para comenzar? ¬°Vamos con la FASE 4.1! üöÄ**
